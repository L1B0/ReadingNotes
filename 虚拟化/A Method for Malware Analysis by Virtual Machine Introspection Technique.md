# A Method for Malware Analysis by Virtual Machine  Introspection Technique(2018)

传统的恶意软件监控工具安装在物理主机中，它们信任主机的完整性，但是，它们很容易受到恶意软件的感染，并提供错误的监控结果[10]。

本文提出了一种基于虚拟机内省技术的方法，利用VirtualBox  API从外部获取虚拟机的内存映像，并分析其内部内容，如运行进程、线程、网络连接、，并使用Volatility框架打开文件，将低级字节解释为高级信息，最后在监控寄存器中报告此信息。



![image-20211129194557647](http://gavinl1b0223342.oss-cn-beijing.aliyuncs.com/img/image-20211129194557647.png)

volatile框架是用Python开发的一组工具，用于从易失性存储器（volatile  memory，RAM）中提取数字工件。该框架不是一个内存获取工具[13]。它支持对不同的来宾操作系统（如macOS、Linux和Windows）进行调查，并从内省虚拟机的内存页中提取操作系统数据结构，识别执行中的进程以及允许在虚拟环境中检测恶意软件的隐藏进程的详细信息[15].



1. 对asset的访问：这是通过名为COM/XPCOM的进程间机制实现的，该机制实现了VirtualBox  API。
2. 收集：它生成虚拟机易失性内存RAM的内存转储。
3. 分析：它借助Volatility工具，通过虚拟机的概要文件将低级字节转换为高级信息，并从操作系统中提取对象。
4. 日志：它生成恶意软件分析的日志。包含进程名称、其标识符、父进程标识符、线程数、网络连接和虚拟机内与之相关的打开文件的纯文本
5. 遏制：COM/XPCOM进程间机制发送kill命令，以从虚拟机外部完成恶意软件的执行。

![image-20211129195121780](http://gavinl1b0223342.oss-cn-beijing.aliyuncs.com/img/image-20211129195121780.png)

